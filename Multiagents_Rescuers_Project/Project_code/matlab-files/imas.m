clear all
close all

map = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
    0 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0;
    0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 0 0 0 1 0;
    0 0 1 0 0 0 0 1 2 0 1 0 0 0 0 0 0 0 1 0;
    0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 0 0 0 1 0;
    0 0 1 0 0 1 1 1 1 1 1 0 0 1 1 1 1 1 1 0;
    0 1 1 0 0 1 0 0 0 0 1 0 0 1 0 0 0 2 1 0;
    0 1 0 0 0 1 0 0 0 1 1 0 0 1 1 0 0 0 1 0;
    0 1 0 0 0 1 0 0 0 1 0 0 0 0 1 0 0 0 1 0;
    0 1 0 0 0 1 0 0 0 1 0 0 0 0 1 0 0 0 1 0;
    0 1 0 0 0 1 0 0 0 1 0 0 0 0 1 0 0 0 1 0;
    0 1 0 0 0 1 0 0 0 1 0 0 0 0 1 0 0 0 1 0;
    0 1 2 0 0 1 0 0 0 1 0 0 0 2 1 3 0 1 1 0;
    0 1 1 0 0 1 0 0 0 1 1 0 0 0 1 0 0 1 0 0;
    0 0 1 0 0 1 0 0 0 0 1 0 0 0 1 0 0 1 0 0;
    0 0 1 0 0 1 0 0 0 0 1 0 0 0 1 0 0 1 0 0;
    0 1 1 0 0 1 1 0 0 1 1 0 0 0 1 0 0 1 1 0;
    0 1 0 0 3 0 1 2 0 1 0 0 0 0 1 0 0 0 1 0;
    0 1 1 1 1 1 1 0 0 1 1 1 1 1 1 0 0 2 1 0;
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

C = getMapCorners(map);
s = extractSegments(map,C);

%% Representacion visual
imagesc(map);
hold on
gscatter(C.corners(:,2),C.corners(:,1),C.isNode,'rg');
colors = ['r' 'g' 'b' 'k' 'm' 'y' 'w'];
for n = 1:size(s,2)
    plot(s(n).points(:,2),s(n).points(:,1),'LineWidth',3,'Color',colors(1 + mod(n,length(colors))),'LineStyle','--');
end
hold off
